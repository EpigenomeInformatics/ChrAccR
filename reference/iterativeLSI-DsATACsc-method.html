<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>iterativeLSI-methods — iterativeLSI,DsATACsc-method • ChrAccR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="iterativeLSI-methods — iterativeLSI,DsATACsc-method" />
<meta property="og:description" content="Perform iterative LSI clustering and dimension reduction as described in doi:10.1038/s41587-019-0332-7" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChrAccR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/singlecell.html">Single-cell analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/articles/resource.html">Resource</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://github.com/GreenleafLab/ChrAccR">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>iterativeLSI-methods</h1>
    
    <div class="hidden name"><code>iterativeLSI-DsATACsc-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform iterative LSI clustering and dimension reduction as described in doi:10.1038/s41587-019-0332-7</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for DsATACsc</span>
<span class='fu'>iterativeLSI</span><span class='op'>(</span>
  <span class='va'>.object</span>,
  it0regionType <span class='op'>=</span> <span class='st'>"t5k"</span>,
  it0nMostAcc <span class='op'>=</span> <span class='fl'>20000L</span>,
  it0pcs <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>25</span>,
  it0clusterResolution <span class='op'>=</span> <span class='fl'>0.8</span>,
  it0clusterMinCells <span class='op'>=</span> <span class='fl'>200L</span>,
  it0nTopPeaksPerCluster <span class='op'>=</span> <span class='fl'>2e+05</span>,
  it1pcs <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>50</span>,
  it1clusterResolution <span class='op'>=</span> <span class='fl'>0.8</span>,
  it1mostVarPeaks <span class='op'>=</span> <span class='fl'>50000L</span>,
  it2pcs <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>50</span>,
  it2clusterResolution <span class='op'>=</span> <span class='fl'>0.8</span>,
  rmDepthCor <span class='op'>=</span> <span class='fl'>0.5</span>,
  normPcs <span class='op'>=</span> <span class='cn'>FALSE</span>,
  umapParams <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>distMethod <span class='op'>=</span> <span class='st'>"euclidean"</span>, min_dist <span class='op'>=</span> <span class='fl'>0.5</span>, n_neighbors <span class='op'>=</span> <span class='fl'>25</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.object</th>
      <td><p><code><a href='DsATACsc-class.html'>DsATACsc</a></code> object</p></td>
    </tr>
    <tr>
      <th>it0regionType</th>
      <td><p>character string specifying the region type to start with</p></td>
    </tr>
    <tr>
      <th>it0nMostAcc</th>
      <td><p>the number of the most accessible regions to consider in iteration 0</p></td>
    </tr>
    <tr>
      <th>it0pcs</th>
      <td><p>the principal components to consider in iteration 0</p></td>
    </tr>
    <tr>
      <th>it0clusterResolution</th>
      <td><p>resolution paramter for Seurat's  clustering (<code>Seurat::FindClusters</code>) in iteration 0</p></td>
    </tr>
    <tr>
      <th>it0clusterMinCells</th>
      <td><p>the minimum number of cells in a cluster in order for it to be considered in peak calling (iteration 0)</p></td>
    </tr>
    <tr>
      <th>it0nTopPeaksPerCluster</th>
      <td><p>the number of best peaks to be considered for each cluster in the merged peak set (iteration 0)</p></td>
    </tr>
    <tr>
      <th>it1pcs</th>
      <td><p>the principal components to consider in iteration 0</p></td>
    </tr>
    <tr>
      <th>it1clusterResolution</th>
      <td><p>resolution paramter for Seurat's  clustering (<code>Seurat::FindClusters</code>) in iteration 1</p></td>
    </tr>
    <tr>
      <th>it1mostVarPeaks</th>
      <td><p>the number of the most variable peaks to consider after iteration 1</p></td>
    </tr>
    <tr>
      <th>it2pcs</th>
      <td><p>the principal components to consider in the final iteration (2)</p></td>
    </tr>
    <tr>
      <th>it2clusterResolution</th>
      <td><p>resolution paramter for Seurat's  clustering (<code>Seurat::FindClusters</code>) in the final iteration (2)</p></td>
    </tr>
    <tr>
      <th>rmDepthCor</th>
      <td><p>correlation cutoff to be used to discard principal components associated with fragment depth (all iterationa)</p></td>
    </tr>
    <tr>
      <th>normPcs</th>
      <td><p>flag indicating whether to apply z-score normalization to PCs for each cell (all iterations)</p></td>
    </tr>
    <tr>
      <th>umapParams</th>
      <td><p>parameters to compute UMAP coordinates (passed on to <code><a href='https://rdrr.io/pkg/muRtools/man/getDimRedCoords.umap.html'>muRtools::getDimRedCoords.umap</a></code> and further to <code><a href='https://rdrr.io/pkg/uwot/man/umap.html'>uwot::umap</a></code>)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an <code>S3</code> object containing dimensionality reduction results, peak sets and clustering</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In order to obtain a low dimensional representation of single-cell ATAC datasets in terms of principal components and UMAP coordinates, we recommend an iterative application of the Latent Semantic Indexing approach [10.1016/j.cell.2018.06.052] described in [doi:10.1038/s41587-019-0332-7]. This approach also identifies cell clusters and a peak set that represents a consensus peak set of cluster peaks in a given dataset. In brief, in an initial iteration clusters are identified based on the most accessible regions (e.g. genomic tiling regions). Here, the counts are first normalized using the term frequency–inverse document frequency (TF-IDF) transformation and singular values are computed based on these normalized counts in selected regions (i.e. the most accessible regions in the initial iteration). Clusters are identified based on the singular values using Louvain clustering (as implemented in the <code>Seurat</code> package). Peak calling is then performed on the aggregated insertion sites from all cells of each cluster (using MACS2) and a union/consensus set of peaks uniform-length non-overlapping peaks is selected. In a second iteration, the peak regions whose TF-IDF-normalized counts which exhibit the most variability across the initial clusters provide the basis for a refined clustering using derived singular values. In the final iteration, the most variable peaks across the refined clusters are identified as the final peak set and singular values are computed again. Based on these final singular values UMAP coordinates are computed for low-dimensional projection.</p>
<p>The output object includes the final singular values/principal components (<code>result$pcaCoord</code>), the low-dimensional coordinates (<code>result$umapCoord</code>), the final cluster assignment of all cells (<code>result$clustAss</code>), the complete, unfiltered initial cluster peak set (<code>result$clusterPeaks_unfiltered</code>) as well as the final cluster-variable peak set (<code>result$regionGr</code>).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Fabian Mueller</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://epigenome-informatics.org'>Fabian Mueller</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


